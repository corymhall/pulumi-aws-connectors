// ~~ Generated by projen. To modify, edit .projenrc.ts and run "npx projen".
import * as aws from '@pulumi/aws';
import * as pulumi from '@pulumi/pulumi';

export interface ApiGatewayRestApiToLambdaFunctionConnectorArgs {
  source: aws.apigateway.RestApi;

  target: aws.lambda.Function;

  sourceQualifier: string;
}

export class ApiGatewayRestApiToLambdaFunctionConnector extends pulumi.ComponentResource {
  constructor(name: string, args: ApiGatewayRestApiToLambdaFunctionConnectorArgs, opts?: pulumi.ComponentResourceOptions) {
    super('aws-connectors:index:ApiGatewayRestApiToLambdaFunctionConnector', name, args, opts);
    const qualifier = args.sourceQualifier ?? '*';

    new aws.lambda.Permission(`${name}-policy`, {
      statementId: 'ApiGatewayRestApiToLambdaFunctionConnector',
      action: 'lambda:InvokeFunction',
      function: args.target.name,
      principal: 'apigateway.amazonaws.com',
      sourceArn: pulumi.interpolate`arn:${aws.getPartitionOutput().partition}:execute-api:${aws.getRegionOutput().name}:${aws.getCallerIdentityOutput().accountId}:${args.source.id}/${qualifier}`,
    });
    this.registerOutputs({});
  }
}